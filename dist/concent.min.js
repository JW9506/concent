!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-dom"],t):t(e.concent={},e.React,e.ReactDOM)}(this,function(e,$,n){"use strict";var t;$=$&&$.hasOwnProperty("default")?$.default:$,n=n&&n.hasOwnProperty("default")?n.default:n;var ee="$$global",V="$$default",B="$$cc",G="$$concent_void_module_624313307",r="$$CONCENT_ROUTER",T="$$CcClass",I="$$CcFrag",j="$$CcHook",C="$$Cc",z="$$Dispatcher",o="__cc_dispatcher_container_designed_by_zzk_qq_is_624313307__",te=Symbol("__for_sync_param_ccsync__"),b=Symbol("__for_mock_event__"),c=Symbol("__lazy_handle_state__"),A=10,D=11,M=13,L="dispatch",re="setState",ne="setModuleState",oe="forceUpdate",O="invoke",g="sync",m="module",ce="ref",ae={CC_ALREADY_STARTUP:1e3,CC_MODULE_NAME_DUPLICATE:1002,CC_MODULE_NOT_FOUND:1012,CC_DISPATCH_STRING_INVALID:1013,CC_DISPATCH_PARAM_INVALID:1014,CC_MODULE_NOT_CONNECTED:1015,CC_CLASS_KEY_DUPLICATE:1100,CC_CLASS_INSTANCE_KEY_DUPLICATE:1200,CC_CLASS_INSTANCE_MORE_THAN_ONE:1205,CC_STORED_KEYS_NEED_CCKEY:1207,CC_REDUCER_NOT_A_FUNCTION:1503,CC_REDUCER_MODULE_NAME_DUPLICATE:1511},a=((t={})[ae.CC_ALREADY_STARTUP]="concent startup method con only be invoked one time, ignore this message if under hot reload mode",t[ae.CC_MODULE_NAME_DUPLICATE]="module name duplicate!",t[ae.CC_MODULE_NOT_FOUND]="module not found!",t[ae.CC_DISPATCH_STRING_INVALID]="when type param is string, it must be one of these format: (fnName)、(moduleName)/(fnName)、(moduleName)/(reducerModuleName)/(fnName)",t[ae.CC_DISPATCH_PARAM_INVALID]="dispatch param type is invalid, it must be string or object",t[ae.CC_MODULE_NOT_CONNECTED]="module not been connected by ref",t[ae.CC_CLASS_INSTANCE_KEY_DUPLICATE]="props.ccKey duplicate",t[ae.CC_CLASS_INSTANCE_MORE_THAN_ONE]="ccClass is declared as singleton, now cc found you are trying new another one instance! ",t[ae.CC_STORED_KEYS_NEED_CCKEY]="you must explicitly specify a ccKey for ccInstance if you want to use storedKeys!",t[ae.CC_CLASS_KEY_DUPLICATE]="ccClassKey duplicate while you register a react class!  ",t[ae.CC_REDUCER_MODULE_NAME_DUPLICATE]="reducer module name duplicate!",t[ae.CC_REDUCER_NOT_A_FUNCTION]="reducer must be a function!",t),i=Object.freeze({MODULE_GLOBAL:ee,MODULE_DEFAULT:V,MODULE_CC:B,MODULE_VOID:G,MODULE_CC_ROUTER:r,CC_CLASS_PREFIX:T,CC_FRAGMENT_PREFIX:I,CC_HOOK_PREFIX:j,CC_PREFIX:C,CC_DISPATCHER:z,CC_DISPATCHER_BOX:o,CCSYNC_KEY:te,MOCKE_KEY:b,LAZY_KEY:c,SIG_FN_START:A,SIG_FN_END:D,SIG_FN_QUIT:12,SIG_FN_ERR:M,SIG_MODULE_CONFIGURED:14,SIG_STATE_CHANGED:15,RENDER_NO_OP:1,RENDER_BY_KEY:2,RENDER_BY_STATE:3,STATE_FOR_ONE_CC_INSTANCE_FIRSTLY:1,STATE_FOR_ALL_CC_INSTANCES_OF_ONE_MODULE:2,EFFECT_AVAILABLE:1,EFFECT_STOPPED:0,DISPATCH:L,SET_STATE:re,SET_MODULE_STATE:ne,FORCE_UPDATE:oe,INVOKE:O,SYNC:g,CATE_MODULE:m,CATE_REF:ce,ERR:ae,ERR_MESSAGE:a,default:{MODULE_GLOBAL:ee,MODULE_DEFAULT:V,MODULE_CC:B,ERR:ae,ERR_MESSAGE:a,STATE_FOR_ONE_CC_INSTANCE_FIRSTLY:1,STATE_FOR_ALL_CC_INSTANCES_OF_ONE_MODULE:2}}),R={alwaysGiveState:!0,isStrict:!1,isDebug:!1,computedCompare:!0,watchCompare:!0,watchImmediate:!1,bindCtxToMethod:!1};function u(e){return null!=e&&0<Object.keys(e).length}function s(e){return!u(e)}function ie(e,t){return void 0===t&&(t=!1),null!==e&&("object"==typeof e&&(!Array.isArray(e)||!!t))}function d(e,t){var r="";r="string"==typeof e?e:a[e]||"",t&&(r+=t),r||(r="undefined message for code:"+e);var n=Error(r);return n.code=e,n}function l(e,t){return e+"$"+t}function f(e){return e?" --verbose-info: "+e:""}function p(e){return void 0===e&&(e="green"),"color:"+e+";border:1px solid "+e}function y(e){return"%c"+e}var v=function(e){return"------------ CC "+e+" ------------"};function x(e){console.error(v("WARNING")),e instanceof Error?(console.error(e.message),console.error(e.stack)):console.error(e)}function U(e){console.log(v("TIP")),console.log("%c"+e,"color:green;border:1px solid green;")}function S(e,t,r){void 0===r&&(r={});var n=e[t];return n||(n=e[t]=r),n}function ue(e,t){var r=e[t];return r||(r=e[t]=[]),r}function h(e){void 0===e&&(e=52);var t=Math.random();return parseInt(t*e)}function _(t,r,n){void 0===r&&(r=[]),Array.isArray(t)?t.length=0:Object.keys(t).forEach(function(e){r.includes(e)||(n?t[e]=n:delete t[e])})}function W(e){return Object.keys(e)}function N(e){var t=null;return e&&(e.currentTarget&&e.type?t=e:e.nativeEvent&&e.target&&(e.currentTarget=e.target,t=e)),t}function E(t,r,e){function n(e){e?e[t]=r:window[t]=r}window?n(e):setTimeout(function(){n(e)},3e3)}function K(e,t){for(var r in e)if(!(r in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1}function se(e,t){var r=[];return e.forEach(function(e){t.includes(e)||r.push(e)}),r}function F(e){return void 0===e&&(e={}),"string"==typeof e?{module:e}:Object.assign({module:V},e)}var w="";function Y(){return w}function k(){var t=null;return{commit:function(e){t||(t={}),Object.assign(t,e)},getFnCommittedState:function(){return t}}}var P,q={},H=((P={})[ee]={},P[V]={},P[B]={},P),X={},J={},Z={_computedValue:H,_computedRaw:J,_computedDep:X,getRootComputedValue:function(){return H},getRootComputedDep:function(){return X},getRootComputedRaw:function(){return J}},Q={},de={},le={_watchRaw:de,_watchDep:Q,getRootWatchDep:function(){return Q},getRootWatchRaw:function(){return de}};var fe={module:{computed:{},watch:{}},ref:{computed:{},watch:{},effect:{}}};function pe(e,t){var r=t[e];return{retKey:e,fn:r.fn,depKeys:r.depKeys}}function ye(e,t,r,n,o,c,a,i){var u=n[o],s=[];if(!u)return{pickedFns:s,setted:[],changed:[]};var d=u.retKey_fn_,l=u.stateKey_retKeys_,f=u.fnCount;if(e){var p=W(d),y=W(a),v=y;return"computed"===r?{pickedFns:p.map(function(e){return pe(e,d)}),setted:y,changed:v}:(p.forEach(function(e){var t=d[e];t.immediate&&s.push({retKey:e,fn:t.fn,depKeys:t.depKeys})}),{pickedFns:s,setted:y,changed:v})}var h=function(r,n){var o=[],c=[];return W(n).forEach(function(e){var t=n[e];void 0!==t&&(c.push(e),t!==r[e]&&o.push(e))}),{changed:o,setted:c}}(c,a),m=h.setted,_=h.changed;if(0===m.length)return{pickedFns:s,setted:[],changed:[]};var C=m.join(",")+"|"+_.join(",")+"|"+o,g=fe[t][r],E=i?S(g,i):g,K=E[C];return K?{pickedFns:K.map(function(e){return pe(e,d)}),setted:m,changed:_}:(function(u,o,s,d,c,l){if(0===o.length)return;var e=c["*"];if(e){var a=0<s.length;e.forEach(function(e){var t=d[e],r=t.fn,n=t.compare,o=t.depKeys,c={retKey:e,fn:r,depKeys:o};n?a&&u.push(c):u.push(c)})}u.length<l&&function(){var i={},e=o.length,t=function(e){var a=o[e],t=c[a];return t?(t.forEach(function(e){if(!i[e]){var t=d[e],r=t.fn,n=t.compare,o=t.depKeys,c=!0;n&&!s.includes(a)&&(c=!1),c&&(i[e]=!0,u.push({retKey:e,fn:r,depKeys:o}))}}),u.length===l?"break":void 0):"continue"};e:for(var r=0;r<e;r++){var n=t(r);switch(n){case"continue":continue;case"break":break e}}}()}(s,m,_,d,l,f),E[C]=s.map(function(e){return e.retKey}),{pickedFns:s,setted:m,changed:_})}function ve(e,t,r){var n=t[r];return void 0!==n&&(e[r]=n,!0)}function he(t,r,e,n){void 0===r&&(r=[]),void 0===e&&(e=!1),void 0===n&&(n=!1);var o={},c=[];if(!ie(t))return{partialState:e?null:o,isStateEmpty:!0,ignoredStateKeys:c};var a=!0,i=W(t);return i.length<r.length?i.forEach(function(e){r.includes(e)?ve(o,t,e)&&(a=!1):n&&c.push(e)}):(r.forEach(function(e){ve(o,t,e)&&(a=!1)}),n&&(c=se(i,r))),a&&e&&(o=null),{partialState:o,isStateEmpty:a,ignoredStateKeys:c}}for(var me,_e=function(h,m,_,C,g,e,E,K,S,w,b,O,U){for(var N=0,A=e,D=!0,t=function(){var e=g(A,1===++N&&w),t=e.pickedFns,n=e.setted,o=e.changed;if(!t.length)return"break";var r=k(),c=r.commit,a=r.getFnCommittedState,i=k(),u=i.commit,s=i.getFnCommittedState;if(t.forEach(function(e){var t=e.retKey,r=function(e,t,r,n,o,c){var a;if(R.alwaysGiveState)a=r(n,o,c);else{var i=t[0];a=1===t.length&&"*"!==i&&i===e?r(n[i],o[i],c):r(n,o,c)}return a}(t,e.depKeys,e.fn,E,C,{retKey:t,callInfo:S,isFirstCall:w,commit:c,commitCu:u,setted:n,changed:o,stateModule:m,refModule:_,oldState:C,committedState:A,refCtx:h});"computed"===b?U[t]=r:!1===r&&(D=!1)}),A=a()){var d=he(A,"ref"===O?h.privStateKeys:q[m],!0,!0),l=d.partialState,f=d.ignoredStateKeys;l&&(Object.assign(E,A=l),Object.assign(K,A)),f.length&&x("these state keys were ignored "+f.join(","))}var p=s();if(p){var y;if("ref"===O)y="computed"===b?h.computedRetKeyFns:h.watchRetKeyFns;else{var v=Z.getRootComputedDep()[m]||{};y=v.retKey_fn_||null}y&&W(p).forEach(function(e){y[e]?U[e]=p[e]:x("fnCtx.commitCu commit an invalid retKey["+e+"] for moduleComputed")})}if(10<N)throw Error("fnCtx.commit may goes endless loop, please check your code")};A;){if("break"===t())break}return D},Ce=Z._computedValue,ge=W,Ee={},Ke=function(r,e,t){var n=void 0===t?{}:t,o=n.refCtx,c=void 0===o?null:o,a=n.callInfo,i=void 0===a?{}:a,u=Se(r),s=we(r),d=Ce[r],l=Z.getRootComputedDep(),f=le.getRootWatchDep(),p=c?c.module:null,y=Object.assign({},u,e),v=Object.assign({},e),h=v;return _e(c,r,p,u,function(e,t){return ye(t,m,"computed",l,r,u,e)},h,y,v,i,!1,"computed",m,d),_e(c,r,p,u,function(e,t){return ye(t,m,"watch",f,r,u,e)},h,y,v,i,!1,"watch",m,d),ge(v).forEach(function(e){s[e]=u[e],be(r,e),u[e]=v[e]}),v},Se=function(e){return Oe[e]},we=function(e){return Ue[e]},be=function(e,t){Ne[e][t]++},Oe={},Ue={},Ne={},Ae={getDispatcher:function(){return Ee[z]},isHotReloadMode:function(){if(Ae.isHot)return!0;var e=!1;return!window||(window.webpackHotUpdate||"previewFrame"===window.name||window.__SANDBOX_DATA__||window.BrowserFS)&&(e=!0),e},runtimeVar:R,isCcAlreadyStartup:!1,moduleSingleClass:{},moduleName_ccClassKeys_:{},moduleName_stateKeys_:q,moduleName_isConfigured_:{},connectedModuleName_ccClassKeys_:{},ccClassKey_ccClassContext_:{},globalStateKeys:[],store:{appendState:function(e,t){var r=ue(q,e);W(t).forEach(function(e){r.includes(e)||r.push(e)}),Ae.store.setState(e,t)},_state:Oe,_prevState:Ue,_stateVer:Ne,getState:function(e){return e?Se(e):Oe},getPrevState:function(e){return e?we(e):Ue},getStateVer:function(e){return e?Ne[e]:Ne},setState:function(e,t,r){return Ke(e,t,r)},setGlobalState:function(e){return Ke(ee,e)},getGlobalState:function(){return Oe[ee]},initStateDangerously:function(e,t){Oe[e]=t}},reducer:{_reducer:(me={},me[ee]={},me[B]={},me),_reducerCaller:{},_reducerFnName_fullFnNames_:{},_reducerModule_fnNames_:{}},computed:Z,watch:le,refStore:{_state:{},setState:function(e,t){var r=Ae.refStore._state,n=Object.assign({},r[e],t);r[e]=n}},init:{_init:{}},ccUkey_ref_:Ee,event_handlers_:{},ccUKey_handlerKeys_:{},handlerKey_handler_:{},renderKey_ccUkeys_:{},refRetKey_fnUid_:{},refs:Ee,info:{startupTime:Date.now(),version:"1.5.150",author:"fantasticsoul",emails:["624313307@qq.com","zhongzhengkai@gmail.com"],tag:"destiny"},fragmentNameCount:0,featureStr_classKey_:{},userClassKey_featureStr_:{},errorHandler:null,middlewares:[],plugins:[]},De=localStorage.length,Ie=Ae.refStore._state,Me=0;Me<De;Me++){var Re=localStorage.key(Me);if(Re.startsWith("CCSS_"))try{Ie[Re.substr(5)]=JSON.parse(localStorage.getItem(Re))}catch(e){console.error(e)}}function xe(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ke=function(e){if(!Ae.errorHandler)throw e;Ae.errorHandler(e)},$e=0,je={},Le={},Fe={},Pe={};function qe(){return++$e}function He(e,t,r,n){if(r){var o=n[e];o||(o=n[e]={});var c=o[t];c?Object.assign(c,r):o[t]=r}}function Ve(e,t,r){He(e,t,r,je)}function Be(e,t,r){return Ve(e,t,r),function(e){var t=function(e){return je[e]}(e),r=[];return W(t).forEach(function(e){r.push({module:e,state:t[e]})}),r}(e)}function Ge(e){delete je[e]}var ze=[A,D,12,M,14,15],We={};function Ye(t,r){We[t].forEach(function(e){e({sig:t,payload:r})})}function Xe(e,t){function r(e,t){var r=We[e];r?r.push(t):console.warn("invalid sig["+e+"]")}Array.isArray(e)?e.forEach(function(e){r(e,t)}):r(e,t)}ze.forEach(function(e){return We[e]=[]});var Je="is not a plain json object!",Ze="should be an string array or *!",Qe=function(e){return e.toLowerCase()===B},et=function(e){return/^[\$\#\&a-zA-Z0-9_-]+$/.test(e)},tt=f,rt=d;function nt(e){if(!et(e))throw Error("module["+e+"] writing is invalid!");if(Qe(e))throw Error("'$$cc' is a built-in module name for concent")}function ot(e,t,r){void 0===t&&(t=!0),void 0===r&&(r="");var n=r||"module["+e+"]",o=Ae.store._state;if(nt(e),e!==ee)if(!0===t){if(u(o[e]))throw rt(ae.CC_MODULE_NAME_DUPLICATE,tt(n))}else if(!o[e])throw rt(ae.CC_MODULE_NOT_FOUND,tt(n))}function ct(t,e){var r=Array.isArray(e);if(!r&&"*"!==e)throw Error("storedKeys type err, it is must be an array or string *");r&&e.forEach(function(e){if(t.includes(e))throw Error("storedKeys key err, the key["+e+"] can not be a module state key!")})}var at={},it=function(e,t,r){void 0===r&&(r=1e3);var n=at[t];n&&clearTimeout(n),at[t]=setTimeout(function(){delete at[t],e()},r)};function ut(e,r,n,t,o,c,a){if(void 0===a&&(a=!1),!e.hasWatchFn)return!0;var i=Object.assign({},t),u=e.watchDep,s=e.module,d=e.ccUniqueKey,l=e.refComputed,f=Object.assign({},n,t),p=_e(e,r,s,n,function(e,t){return ye(t,"ref","watch",u,r,n,e,d)},t,f,i,o,c,"watch",ce,l);return a&&Object.assign(t,i),p}function st(e,r,n,t,o,c,a){void 0===c&&(c=!1),void 0===a&&(a=!1);var i=Object.assign({},t);if(!e.hasComputedFn)return i;var u=e.computedDep,s=e.module,d=e.refComputed,l=e.ccUniqueKey,f=Object.assign({},n,t);return _e(e,r,s,n,function(e,t){return ye(t,ce,"computed",u,r,n,e,l)},t,f,i,o,c,"computed",ce,d),a&&Object.assign(t,i),i}var dt=ie,lt=x,ft=u,pt=function(e,t){return e+"/"+Object.keys(t).sort().join("|")},yt=W,vt=se,ht=1,mt=2,_t=oe,Ct=re,gt=ne,Et=O,Kt=g,St=15,wt=1,bt=2,Ot=3,Ut=Ae.store,Nt=Ut.setState,At=Ut.getPrevState,Dt=Ae.middlewares,It=Ae.moduleName_ccClassKeys_,Mt=Ae.ccClassKey_ccClassContext_,Rt=Ae.connectedModuleName_ccClassKeys_,xt=Ae.refStore,Tt=Ae.moduleName_stateKeys_,kt=Ae.ccUkey_ref_,$t=Ae.renderKey_ccUkeys_;function jt(e,t,r){var n=void 0===t?{}:t,o=n.module,c=n.skipMiddleware,a=void 0!==c&&c,i=n.payload,u=n.reactCallback,s=n.type,d=n.reducerModule,l=n.calledBy,f=void 0===l?Ct:l,p=n.fnName,y=void 0===p?"":p,v=n.renderKey,h=void 0===v?"":v,m=n.delay,_=void 0===m?-1:m;if(void 0!==e)if(dt(e)){var C=r.ctx,g=C.module,E=C.ccUniqueKey,K=C.ccKey,S=function(e,t){return e===t?ht:mt}(o,g),w={calledBy:f,type:s,payload:i,renderKey:h,delay:_,ccKey:K,ccUniqueKey:E,state:e,refModule:g,module:o,reducerModule:d,fnName:y},b={payload:i,renderKey:h,ccKey:K},O=function(e,t,r){var n=he(t,Tt[e],!0).partialState;if(n){var o=Nt(e,n,r);return Object.assign(n,o),n}return n}(o,e,{refCtx:S===ht?r.ctx:null,callInfo:b});Object.assign(e,O),Lt(r,b,h,f,e,S,u,function(e,t){e===wt&&!O||Ye(St,{committedState:t,sharedState:O,module:o,type:function(e,t){return[_t,Ct,gt,Et,Kt].includes(e)?"ccApi/"+e:"dispatch/"+t}(f,s),ccUniqueKey:E,renderKey:h}),O&&function(e,t,r,n,o,c,a){var i=function(){!function(d,e,l,t,r,n){if(!l)return;var o=e.ctx,f=o.ccUniqueKey,c=Mt[o.ccClassKey].renderKeyClasses,p=t===ht,y=It[r]||[],v=[];if(n){y="*"===c?[]:vt(y,c);var a=$t[n]||[],i=function(e,t){var r=e.indexOf(t);if(-1<r){var n=e.slice();return n.splice(r,1),n}return e}(a,f);(function(e,n,o,c){e.forEach(function(e){var t=kt[e],r=t.ctx.module;r===n?Lt(t,c,null,"broadcastState",o,ht):U("although ref's renderKey matched but its module "+r+" mismatch target module "+n+", cc will ignore trigger it re-render")})})(v=i,r,l,d)}for(var u=y.length,s=function(e){var t=y[e],r=Mt[t],n=r.ccKeys,o=r.watchedKeys,c=r.originalWatchedKeys;if(0===n.length)return"continue";if(0===o.length)return"continue";var a=void 0;if("*"===c)a=l;else{var i=he(l,o,!0),u=i.partialState,s=i.isStateEmpty;if(s)return"continue";a=u}n.forEach(function(e){if(!(v.includes(e)||e===f&&p)){var t=kt[e];t&&Lt(t,d,null,"broadcastState",a,ht)}})},h=0;h<u;h++)s(h);!function(r,n,o){var c=yt(n);(Rt[r]||[]).forEach(function(e){var t=Mt[e];!function(e,o,c,t,a){var r=e.connectedModuleKeyMapping;if(1===e.connectedModule[o]){for(var n=e.ccKeys,i=!1,u=t.length,s=0;s<u;s++){var d=o+"/"+t[s];if(r[d]){i=!0;break}}if(!0===i){var l=At(o);n.forEach(function(e){var t=kt[e];if(t&&!0!==t.__$$isUnmounted){var r=t.ctx;st(r,o,l,c,a);var n=ut(r,o,l,c,a);n&&r.__$$ccForceUpdate()}})}}}(t,r,n,c,o)})}(r,l,d)}(e,t,r,n,o,c)};if(0<a){var u=pt(t.ctx.ccUniqueKey,r);it(i,u,a)}else i()}(b,r,O,S,o,h,_)},a,w)}else lt("your committed state "+Je)}function Lt(e,t,r,n,o,c,a,i,u,s){var d=e.state,l=e.ctx;if(!0===e.__$$isUnmounted||c!==ht||n!==_t&&!ft(o))return a&&a(d),i&&i(wt,o);var f=l.module,p=l.storedKeys,y=l.ccUniqueKey,v=Ot;if(r&&(v=bt,l.renderKey!==r))return i&&i(wt,o);if(0<p.length){var h=he(o,p),m=h.partialState;if(!h.isStateEmpty){if(!0===l.persistStoredKeys){var _=he(d,p),C=Object.assign({},_.partialState,m);localStorage.setItem("CCSS_"+y,JSON.stringify(C))}xt.setState(y,m)}}function g(){return l.__$$ccSetState(E,a,K)}var E=st(l,f,d,o,t),K=ut(l,f,d,E,t,!1,!0);i?(s.state=E,function(e,r,n){if(!0!==e){var o=Dt.length;if(0<o){var c=0;!function e(){if(c===o)n();else{var t=Dt[c];c++,t(r,e)}}()}else n()}else n()}(u,s,function(){g(),i(v,E)})):g()}function Ft(e,t){void 0===t&&(t=!1);var r=Ae.ccUkey_ref_,n=Ae.moduleName_ccClassKeys_,o=Ae.ccClassKey_ccClassContext_,c=[];if(e){if(!Ae.store._state[e])throw Error("module["+e+"] is not declared in store");var a=n[e];if(a&&0!==a.length){var i=a[0],u=o[i];if(!u)throw Error("no ccClassContext found for ccClassKey "+i+"!");c=u.ccKeys}if(e===V&&(c=c.filter(function(e){return!e.startsWith(I)})),0===c.length){if(!1!==t){throw Error("[[pickOneRef]]: no ref found for module["+e+"]!,if this message doesn't matter, you can ignore it")}c=[z]}}else c=[z];var s=r[c[0]];if(!s)throw Error("cc found no ref!");return s}function Pt(e,t,r,n,o){void 0===n&&(n=-1);try{Ft(e).ctx.changeState(t,{ccKey:"[[top api:setState]]",module:e,renderKey:r,delay:n,skipMiddleware:o})}catch(e){!function(e){if(console.error(v("WARNING")),console.error(e),R.isStrict)throw e}(e)}}var qt=Ae.store.setState,Ht=Ae.globalStateKeys,Vt="note! you are trying set state for global module, but the state you commit include some invalid keys which is not declared in cc's global state, \ncc will ignore them, but if this result is not as you expected, please check your committed global state!";var Bt=x,Gt=Ae.store,zt=Gt.getState,Wt=Gt.setState,Yt=Ae.reducer._reducer,Xt=Ae.computed._computedValue,Jt=d,Zt=f;function Qt(e,t){void 0===t&&(t=!0);try{return ot(e,!1,"module["+e+"] is not configured in store"),!0}catch(e){return function(e,t){if(void 0===t&&(t=!0),t)throw e;rr(e)}(e,t),!1}}function er(o,c){return function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e?c(e):o.apply(void 0,r)}}function tr(e,t,r,n){var o;return!0===e?(function(e){Fe[e]=!0}(o=qe()),n[o]=1):n[o=t||qe()]||(n[o]=1),{_chainId:o,_oriChainId:r||o}}function rr(e,t){e&&(t?t(e):(Bt(e),Ae.errorHandler&&Ae.errorHandler(e)))}function nr(e,t,r){return function(n,o,c,a){return new Promise(function(e,t){var r=Object.assign(c,{__innerCb:er(e,t)});n(o,r,a)}).catch(ke)}(ur,e,t,r)}function or(e,t,r){return nr(e,{callerRef:t.callerRef,context:!0,module:t.module,calledBy:t.calledBy,fnName:e.name,delay:t.delay,renderKey:t.renderKey,chainId:t.chainId,oriChainId:t.oriChainId,chainId_depth_:t.chainId_depth_,isSilent:t.isSilent},r)}function cr(c,a){return function(e,t,r){var n=c.ctx,o=Object.assign({},n.state,e);n.state=o,a&&(a.state=o),n.type===j&&(c.state=o),r?(n.renderCount+=1,n.reactSetState(e,t)):n.type!==j&&Object.assign(c.state,e)}}function ar(r){return function(e){var t=r.ctx;t.renderCount+=1,t.reactForceUpdate(e)}}function ir(_,e){var t=void 0===e?{}:e,C=t.chainId,g=t.oriChainId,E=t.isLazy,r=t.delay,K=void 0===r?-1:r,n=t.isSilent,S=void 0!==n&&n,o=t.chainId_depth_,w=void 0===o?{}:o;return function(e,t,r,n){var o=E,c=S,a="",i=null!=n?n:K;if(r&&"object"==typeof r){var u=r.lazy,s=r.silent,d=r.renderKey,l=r.delay;void 0!==u&&(o=u),void 0!==s&&(c=s),void 0!==d&&(a=d),void 0!==l&&(i=l)}else a=r;var f,p,y=tr(o,C,g,w),v=typeof e,h={callerRef:_,calledBy:O,module:_.ctx.module,isSilent:c,chainId:y._chainId,oriChainId:y._oriChainId,chainId_depth_:w,delay:i,renderKey:a},m=Error("param type error, correct usage: invoke(userFn:function, ...args:any[]) or invoke(option:[module:string, fn:function], ...args:any[])");if("function"==v)return e.__fnName&&(e.name=e.__fnName),or(e,h,t);if("object"!=v)throw m;if(p=Array.isArray(e)?(f=e[1],e[0]):(f=e.fn,e.module),"function"!=typeof f)throw m;return p&&(h.module=p),or(f,h,t)}}function ur(f,e,p){var y=e.callerRef,v=y.ctx.module,t=e.module,h=void 0===t?v:t,r=e.context,m=void 0!==r&&r,_=e.__innerCb,C=e.type,g=e.reducerModule,E=e.calledBy,K=e.fnName,n=e.delay,S=void 0===n?-1:n,w=e.renderKey,b=e.chainId,O=e.oriChainId,U=e.chainId_depth_,N=e.isSilent;!function(e,t,r,n){var o=r;Qt(e,!1)?(e!==t&&r&&(Bt(function(e,t){return"param module["+e+"] must equal current ref's module["+t+"] when pass param reactCallback, or it will never been triggered! "}(e,t)),o=null),n(null,o)):n(Error("inputModule:"+e+" invalid"),null)}(h,v,e.cb,function(e,n){if(e)return rr(e,_);var o,t=zt(h),r={};if(o=b===O&&1===U[b],m){U[b]=U[b]+1;var c=sr(y,!1,N,h,g,w,S,b,O,U),a=sr(y,!1,!0,h,g,w,S,b,O,U),i=sr(y,!0,N,h,g,w,S,b,O,U),u=ir(y,{delay:S,chainId:b,oriChainId:O,chainId_depth_:U}),s=ir(y,{isLazy:!0,delay:S,oriChainId:O,chainId_depth_:U}),d=ir(y,{isLazy:!1,delay:S,isSilent:!0,oriChainId:O,chainId_depth_:U}),l=function(e){return Pe[e]}(b)||{};r={module:h,callerModule:v,committedStateMap:l,committedState:l[h]||{},invoke:u,lazyInvoke:s,silentInvoke:d,invokeLazy:s,invokeSilent:d,dispatch:c,lazyDispatch:i,silentDispatch:a,dispatchLazy:i,dispatchSilent:a,rootState:zt(),globalState:zt(ee),moduleState:t,moduleComputed:Xt[h]||{},setState:function(e){return c("setState",e,{silent:N,renderKey:w,delay:S})},refCtx:y.ctx}}!1===N&&Ye(A,{isSourceCall:o,calledBy:E,module:h,chainId:b,fn:f}),new Promise(function(e){return e(f(p,t,r))}).then(function(e){U[b]=U[b]-1;var t=1===U[b];!function(e,t,r){He(e,t,r,Pe)}(b,h,e);var r=[];!1===N&&(Ye(D,{isSourceCall:o,calledBy:E,module:h,chainId:b,fn:f}),!function(e){return!0===Fe[e]}(b)?r=[{module:h,state:e}]:t?function(e){return!0===Le[e]}(b)||(r=Be(b,h,e),Ge(b)):Ve(b,h,e)),r.forEach(function(e){e.state&&jt(e.state,{renderKey:w,module:e.module,reactCallback:n,type:C,reducerModule:g,calledBy:E,fnName:K,delay:S,payload:p},y)}),o&&(Ge(b),function(e){delete Pe[e]}(b)),_&&_(null,e)}).catch(function(e){Ye(M,{isSourceCall:o,calledBy:E,module:h,chainId:b,fn:f}),rr(e,_)})})}function sr(N,A,D,I,M,R,x,T,k,$){return void 0===R&&(R=""),void 0===x&&(x=-1),void 0===$&&($={}),function(e,r,t,n){void 0===e&&(e={});var o,c=A,a=D,i=n||x;if("object"==typeof t){o=R;var u=t.lazy,s=t.silent,d=t.renderKey,l=t.delay;void 0!==u&&(c=u),void 0!==s&&(a=s),void 0!==d&&(o=d),void 0!==l&&(i=l)}else o=t||R;function f(){return ir(N,{chainId:h,oriChainId:m,isLazy:c,chainId_depth_:$})(e,r,o,i)}var p,y,v=tr(c,T,k,$),h=v._chainId,m=v._oriChainId,_=typeof e,C=I,g=M||I;if(_&&"object"==_){if(Array.isArray(_))return f();var E=e.module;E&&(C=E),g=e.reducerModule||E||M,p=e.type,y=e.cb}else{if("string"!=_&&"function"!=_)return Promise.reject(Jt(ae.CC_DISPATCH_PARAM_INVALID));var K=e;if("function"==_){var S=e.__fnName;if(!S)return f();K=S,1==$[m]&&(C=e.__stateModule,g=e.__reducerModule)}var w=K.split("").filter(function(e){return"/"===e}).length;if(0===w)p=K;else if(1===w){var b=K.split("/");g=C=b[0],p=b[1]}else{if(2!==w)return Promise.reject(Jt(ae.CC_DISPATCH_STRING_INVALID,Zt(K)));var O=K.split("/"),U=O[0];U&&(C=U),g=O[1],p=O[2]}}return"*"===C?Promise.reject("cc instance api dispatch do not support multi dispatch, please use top api[cc.dispatch] instead!"):new Promise(function(e,t){!function(e){var t=void 0===e?{}:e,r=t.callerRef,n=t.module,o=t.reducerModule,c=t.renderKey,a=t.isSilent,i=t.type,u=t.payload,s=t.cb,d=t.__innerCb,l=t.delay,f=void 0===l?-1:l,p=t.chainId,y=t.oriChainId,v=t.chainId_depth_,h=Yt[o];if(!h)return d(Error("no reducerMap found for reducer module:"+o));var m=h[i];if(!m)return d(Error("no reducer defined in ccContext for reducer module:"+o+" type:"+i+", maybe you want to invoke one of them:"+Object.keys(h)));ur(m,{callerRef:r,module:n,reducerModule:o,type:i,cb:s,context:!0,__innerCb:d,calledBy:L,delay:f,renderKey:c,isSilent:a,chainId:p,oriChainId:y,chainId_depth_:v},u)}({callerRef:N,module:C,reducerModule:g,type:p,payload:r,cb:y,__innerCb:er(e,t),delay:i,renderKey:o,isSilent:a,chainId:h,oriChainId:m,chainId_depth_:$})}).catch(ke)}}function dr(o){return function(t){try{Pt(o,t)}catch(e){if(o===ee)!function(e,t,r){void 0===t&&(t=""),void 0===r&&(r="");var n=he(e,Ht),o=n.partialState,c=n.isStateEmpty,a=W(o),i=W(e);if(a.length<i.length){var u=i.filter(function(e){return!a.includes(e)});x(Vt+",invalid keys: "+u.join(",")+", make sure the keys is invalid and their values are not undefined"),console.log(e),t&&x("module is "+t),r&&x("ccClassKey is "+r)}qt(ee,o)}(t,o);else{var r=zt(o);if(!r)return x("invalid module "+o);var n=he(t,W(r));n.isStateEmpty||Wt(o,n.partialState)}U("no ccInstance found for module["+o+"] currently, cc will just store it, lately ccInstance will pick this state to render")}}}var lr=W,fr=ie,pr=Ae.store._state;var yr=s,vr=d,hr=Ae.featureStr_classKey_,mr=Ae.userClassKey_featureStr_,_r=Ae.ccClassKey_ccClassContext_,Cr=0;var gr=Ae.moduleName_stateKeys_,Er=Ae.moduleName_ccClassKeys_,Kr=Ae.moduleSingleClass,Sr=Ae.ccClassKey_ccClassContext_,wr=Ae.connectedModuleName_ccClassKeys_,br=Ae.computed._computedValue,Or=function(e,t){var r=!1,n=!1;if(!Array.isArray(e))return{duplicate:r,notArray:!0,keyElementNotString:n};if(!Array.isArray(t))return{duplicate:r,notArray:!0,keyElementNotString:n};var o=e.length,c=t.length;e:for(var a=0;a<o;a++){var i=e[a];if("string"!=typeof i){n=!0;break e}for(var u=0;u<c;u++){var s=t[u];if("string"!=typeof s){n=!0;break e}if(s===i){r=!0;break e}}}return{duplicate:r,notArray:!1,keyElementNotString:n}},Ur=f;function Nr(e,t,r,n,o,c,a,i,u,s){void 0===e&&(e=V),void 0===c&&(c=[]),!0===u&&function(){if(!0!==Ae.isCcAlreadyStartup)throw Error("you must startup cc by call startup method before register ReactClass to cc!")}();var d="cc"===s,l=i||e;ot(e,!1,"module["+e+"] is not configured in store"),ct(gr[e],c);var f=a;Array.isArray(a)&&(f={},a.forEach(function(e){return f[e]="*"}));var p,y=function(e,t,r){if(!r)return[];if("*"===r)return gr[e];var n=Or(r,[]);if(n.notArray||n.keyElementNotString)throw Error("watchedKeys "+Ze+" "+Ur("ccClassKey:"+t));return r}(e,t,o),v=function(o,e,t,c){if(!fr(o))throw Error("CcFragment or CcClass's prop connect type error, it "+Je);function a(e){return i+" module["+e+"]'s value must be * or array of string"}var i="CcFragment or CcClass's prop connect is invalid,",r=lr(o);r.sort();var u=[],s={};if(r.forEach(function(t){var r=pr[t],n=c+"_"+t+"/";if(void 0===r)throw Error(i+" module["+t+"] not found in cc store ");var e=o[t];if("string"==typeof e){if("*"!==e)throw Error(a(t));u.push(n+"*"),lr(r).forEach(function(e){return s[t+"/"+e]=e})}else{if(!Array.isArray(e))throw Error(a(t));e.forEach(function(e){if(!r.hasOwnProperty(e))throw Error(i+" module["+t+"]'s key["+e+"] not declared in cc store ");n+=e+",",s[t+"/"+e]=e}),u.push(n)}}),u.push("|"),"*"===e)u.push(c+"_$"+t+"/*");else{e.sort();var n=t+"/"+e.join(",");u.push(n)}return{featureStr:u.join("@"),connectedModuleKeyMapping:s,connectedModuleNames:r}}(f,y),h=v.connectedModuleKeyMapping,m=v.connectedModuleNames,_=function(e,t,r,n,o,c,a){if(void 0===a&&(a=""),!a){if(t===V&&yr(r)&&0===n.length)return o+"0";var i=o+":"+c,u=hr[i];return u||(hr[i]=u=""+o+ ++Cr)}if(a.startsWith(C))throw Error("user can not specify a classKey["+a+"] starts with $$Cc");if(!e&&a.toLowerCase()==z.toLowerCase())throw Error(z+" is cc built-in ccClassKey name, if you want to customize your dispatcher, \n      you can set autoCreateDispatcher=false in StartupOption, and use createDispatcher then.");if(_r[a]){if(mr[a]!==c)throw vr(ae.CC_CLASS_KEY_DUPLICATE,"ccClassKey:["+a+"] duplicate")}else mr[a]=c;return a}(d,e,f,y,n,v.featureStr,t);if(r){if(!Array.isArray(r)&&"*"!==r)throw Error("renderKeyClasses type err, it is must be an array or string *");p=r}else p=[_];return function(r,e,t,n,o,c,a){var i=Sr[r];i||(i=function(e,t,r,n,o){return{module:e,ccClassKey:t,renderKeyClasses:r,originalWatchedKeys:o,watchedKeys:n,ccKeys:[],connectedState:{},connectedModuleKeyMapping:null,connectedModule:{}}}(t,r,e,o,n),Sr[r]=i);var u={},s={};if(c){var d=Ae.store._state,l=i.connectedState;a.forEach(function(e){l[e]=d[e],s[e]=br[e],u[e]=1;var t=ue(wr,e);t.includes(r)||t.push(r)}),i.connectedModuleKeyMapping=c,i.connectedModule=u,i.connectedComputed=s}}(_,p,e,o,y,h,m),function(e,t){var r=ue(Er,e);if(!0===Kr[e]&&1<=r.length)throw Error("module["+e+"] is declared as single, only on ccClassKey can been registered to it, and now a ccClassKey["+r[0]+"] has been registered!");r.includes(t)||r.push(t)}(e,_),{_module:e,_reducerModule:l,_connect:f,_watchedKeys:y,_ccClassKey:_}}var Ar=x,Dr=d,Ir=f,Mr=y,Rr=p,xr=Ae.runtimeVar,Tr=Ae.ccClassKey_ccClassContext_,kr=Ae.ccUkey_ref_,$r={};function jr(e,t,r,n){function o(){kr[e]=t,r.push(e)}!function(e){void 0===$r[e]?$r[e]=1:$r[e]+=1}(e),n?setTimeout(o,n):o()}function Lr(e,t,r,n,o){var c=Tr[r],a=c.ccKeys;xr.isDebug&&console.log(Mr("register ccKey "+o+" to CC_CONTEXT"),Rr());var i=Ae.isHotReloadMode();if(a.includes(o))if(i){var u=function(e){return void 0===$r[e]?0:$r[e]}(o);if(t&&0<u)throw Dr(ae.CC_CLASS_INSTANCE_MORE_THAN_ONE,Ir("ccClass:"+r));1<u&&function(){throw Dr(ae.CC_CLASS_INSTANCE_KEY_DUPLICATE,Ir("ccClass:"+r+",ccKey:"+o))}(),Ar("\n        found ccKey["+n+"] duplicated in hot reload mode, please make sure your ccKey is unique manually,\n        "+Ir("ccClassKey:"+r+" ccKey:"+n+" ccUniqueKey:"+o)+"\n      "),jr(o,e,a,600)}else dupErr();else jr(o,e,a);return c}var Fr=Ae.event_handlers_,Pr=Ae.handlerKey_handler_,qr=Ae.ccUKey_handlerKeys_,Hr=Ae.ccUkey_ref_,Vr=function(e,t,r){return e+"$"+t+"$"+r},Br=ue,Gr=x;function zr(e,t,r,n,o){void 0===o&&(o=null);var c=Fr[e];if(c){var a=c;return n?a=c.filter(function(e){return e.ccUniqueKey===n}):r?a=c.filter(function(e){return e.ccClassKey===r}):t&&(a=c.filter(function(e){return e.module===t})),void 0!==o&&(a=a.filter(function(e){return e.identity===o})),a}return[]}function Wr(e){var o={},n=[];e.forEach(function(e){var t=e.ccUniqueKey,r=e.event;delete Pr[e.handlerKey],o[t]=1,n.includes(r)||n.push(r)}),n.forEach(function(e){var n=Fr[e];n&&(n.forEach(function(e,t){var r=e.ccUniqueKey;1===o[r]&&(n[t]=null,delete qr[r])}),Fr[e]=n.filter(function(e){return null!==e}))})}function Yr(e,t,r,n,o,c){var a=Br(Fr,n);if("function"!=typeof c)return Gr("event "+n+"'s handler is not a function!");var i=Vr(r,n,o),u=Br(qr,r),s=a.findIndex(function(e){return e.handlerKey===i}),d={event:n,module:e,ccClassKey:t,ccUniqueKey:r,identity:o,handlerKey:i,fn:c};-1<s?a[s]=d:(a.push(d),u.push(i)),Pr[i]=d}function Xr(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o,c,a,i,u=null;"string"==typeof e?o=e:(o=e.name,u=e.identity,c=e.module,a=e.ccClassKey,i=e.ccUniqueKey),zr(o,c,a,i,u).forEach(function(e){var t=e.handlerKey;if(Hr[e.ccUniqueKey]&&t){var r=Pr[t];r&&r.fn.apply(r,n)}})}function Jr(e,t){Wr(zr(e,t.module,t.ccClassKey,t.ccUniqueKey,t.identity))}function Zr(e){var t=qr[e];if(t){var r=[];t.forEach(function(e){return r.push(Pr[e])}),Wr(r)}}function Qr(e){if(e&&"object"==typeof e){var t;if(Array.isArray(e))t={name:e[0],identity:e[1]};else t=Object.assign({},e);return t}return{name:e}}var en=Object.freeze({bindEventHandlerToCcContext:Yr,findEventHandlersToPerform:Xr,findEventHandlersToOff:Jr,offEventHandlersByCcUniqueKey:Zr,getEventItem:Qr}),tn=0,rn=["a","A","b","B","c","C","d","D","e","E","f","F","g","G","h","H","i","I","j","J","k","K","l","L","m","M","n","N","o","O","p","P","q","Q","r","R","s","S","t","T","u","U","v","V","w","W","x","X","y","Y","z","Z"];function nn(e){return tn++,(e||function(e){void 0===e&&(e=6);for(var t="",r=0;r<e;r++)t+=rn[h()];return t}())+"_"+tn}var on=Ae.moduleName_stateKeys_,cn=Ae.refRetKey_fnUid_,an=Ae.runtimeVar;function un(e,t,r,n,o,c,a){if(r){var i,u,s,d=typeof r;if("string"==d)i="object"==typeof n?((u={})[r]=n,u):((s={})[r]={fn:n,depKeys:o,compare:c,immediate:a},s);else if("object"==d)i=r;else if("function"==d&&!ie(i=r(t.refCtx)))throw Error("type of "+t.type+" callback result must be an object");i&&function(O,U,N){var e=an.computedCompare,t=an.watchCompare,A=an.watchImmediate,D="computed"===U.type?e:t,I=U.module;W(N).forEach(function(a){var e=N[a],t=typeof e,r=e;if("function"==t&&(r={fn:e}),"object"==typeof r){var n=r,o=n.fn,c=n.depKeys,i=n.immediate,u=void 0===i?A:i,s=n.compare,d=void 0===s?D:s,l=nn("mark");if("*"===c){var f=ln(U,I,a),p=f.isStateKey,y=f.stateKey;if(!p)throw Error("retKey["+a+"] is not a state key of module["+I+"]");sn(O,U,l,y),dn(O,U,I,y,o,c,u,d)}else{if(c&&!Array.isArray(c))throw Error("depKeys must an string array or *");if(c&&0!==c.length){var v="",h=a;if(a.includes("/")){var m=a.split("/"),_=m[0],C=m[1];v=_,h=C}sn(O,U,l,h);var g={};c.forEach(function(e){var t=ln(U,I,e),r=t.isStateKey,n=t.stateKey,o=t.module;if(v&&o!==v)throw Error("including slash both in retKey["+a+"] and depKey["+e+"] founded, but their module is different");var c=ue(g,o);if(!r)throw Error("depKey["+e+"] invalid, module["+o+"] doesn't include its stateKey["+n+"]");c.push(n)}),W(g).forEach(function(e){dn(O,U,e,h,o,g[e],u,d)})}else{var E=ln(U,I,a),K=E.isStateKey,S=E.stateKey,w=E.module,b=[];!c&&K&&(b=[S]),sn(O,U,l,S),dn(O,U,w,S,o,b,u,d)}}}})}(e,t,i)}}function sn(e,t,r,n){if(e===ce){var o=t.refCtx.ccUniqueKey,c=t.type,a=o+"_"+c+"_"+n;if(cn[a])throw Error("ccUKey["+o+"], retKey["+n+"] duplicate in ref "+c);cn[a]=r}}function dn(e,t,r,n,o,c,a,i){var u=S(t.dep,r,{retKey_fn_:{},stateKey_retKeys_:{},fnCount:0}),s=u.retKey_fn_,d=u.stateKey_retKeys_,l={fn:o,immediate:a,compare:i,depKeys:c};s[n]?e!==ce&&(s[n]=l):(s[n]=l,u.fnCount++);var f=c;"*"===c&&(f=["*"]),e===ce&&(t.retKeyFns[n]=s[n]);var p=t.refCtx;p&&("computed"===t.type?p.hasComputedFn=!0:p.hasWatchFn=!0),f.forEach(function(e){ue(d,e).push(n)})}function ln(e,t,r){var n,o=t,c=r;if(r.includes("/")){var a=r.split("/"),i=a[0];i&&(o=i),c=a[1]}if(o===e.module)n=e.stateKeys;else{if(!(n=on[o]))throw d(ae.CC_MODULE_NOT_FOUND,f("module["+o+"]"));if(!e.connect[o])throw d(ae.CC_MODULE_NOT_CONNECTED,f("module["+o+"], stateKey["+c+"]"))}return{isStateKey:n.includes(c),stateKey:c,module:o}}var fn=x,pn=l;function yn(e){return e?e.props||e:{}}var vn=Ae.store.getState;function hn(e){var t=N(e);return t?t.currentTarget.value:e}var mn=function(e,t,r){var n,o=r.module,c=r.state,a=!1,i="",u="",s="",d=void 0,l=-1,f=!1,p=e[te],y=e.type,v=!1;if(void 0!==p)if(i=p,l=e.delay,u=e.rkey,"val"===y||"int"===y){a="int"===y;var h=e.val;if(void 0===h)s=hn(t);else if("function"==typeof h){var m,_,C;if(i.includes("/")){var g=i.split("/");m=g[1],_=i,C=g[0]}else _=o+"/"+(m=i),C=o;v=!0,d=h(hn(t),m,{moduleState:vn(C),fullKeyPath:_,state:c,refCtx:r})}else s=h}else{if("bool"!==y)return null;f=!0}else{var E=N(t);if(!E)return null;var K=E.currentTarget;s=K.value;var S=K.dataset;if(a="int"===y||void 0!==S.ccint,!(i=S.ccsync))return null;u=S.ccrkey;var w=S.ccdelay;if(w)try{l=parseInt(w)}catch(e){}}return(n={})[b]=1,n.currentTarget={value:s,extraState:d,hasSyncCb:v,dataset:{ccsync:i,ccint:a,ccdelay:l,ccrkey:u}},n.isToggleBool=f,n};var _n=function(e,t,r,n,o){var c=t;!0!==r||Number.isNaN(c=parseInt(t))&&(x(t+" can not convert to int but you set ccint as true!！"),c=t);var a=null,i=[];if(e.includes("/")){var u=e.split("/"),s=u[1];a=u[0],i=s.includes(".")?s.split("."):[s]}else i=e.includes(".")?e.split("."):[e];if(1===i.length){var d,l,f=i[0];return!0!==o?{module:a,state:(d={},d[f]=c,d)}:{module:a,state:(l={},l[f]=!n[f],l)}}var p,y=i[0],v=i.slice(1),h=n[y];return function e(t,r,n,o,c,a){void 0===a&&(a=!1);var i=r[o];if(n===o)if(!0===a){var u=t[i];"boolean"!=typeof u?x("key["+i+"]'s value type is not boolean"):t[i]=!u}else t[i]=c;else e(t[i],r,n,++o,c,a)}(h,v,v.length-1,0,c,o),{module:a,state:(p={},p[y]=h,p)}},Cn=Ae.store.getState;function gn(e,t,r){var n=t.ctx,o=n.module,c=null;if(c=e[b]?e:mn(e,r,n)){var a=c.currentTarget,i=a.dataset,u=a.value,s=a.extraState,d=a.hasSyncCb;r&&r.stopPropagation&&r.stopPropagation();var l=i.ccsync,f=i.ccint,p=i.ccdelay,y=i.ccrkey;if(l.startsWith("/")&&(i.ccsync=""+o+l),l.includes("/")){var v=l.split("/")[0];ot(v,!1);var h=n.ccKey,m=n.ccUniqueKey;if(d)return void(s&&jt(s,{calledBy:g,ccKey:h,ccUniqueKey:m,module:v,renderKey:y,delay:p},t));var _=v!==o?Cn(v):t.state;jt(_n(l,u,f,_,c.isToggleBool).state,{calledBy:g,ccKey:h,ccUniqueKey:m,module:v,renderKey:y,delay:p},t)}else{if(d)return void(s&&t.setState(s,null,y,p));var C=_n(l,u,f,t.state,c.isToggleBool);t.setState(C.state,null,y,p)}}}var En=Ae.refStore,Kn=Ae.ccClassKey_ccClassContext_,Sn=Ae.moduleName_stateKeys_,wn=Ae.store.getState,bn=Ae.moduleName_ccClassKeys_,On=Ae.computed._computedValue,Un=Ae.renderKey_ccUkeys_,Nn=W,An=d,Dn=f,In=ue,Mn=0;function Rn(c,e,t){var r;void 0===t&&(t=5);var n=c.setState.bind(c),o=c.forceUpdate.bind(c),a=e.isSingle,i=e.ccClassKey,u=e.ccKey,s=void 0===u?"":u,d=e.module,l=e.reducerModule,f=e.type,p=e.state,y=e.storedKeys,v=void 0===y?[]:y,h=e.persistStoredKeys,m=e.watchedKeys,_=e.connect,C=void 0===_?{}:_,g=e.tag,E=void 0===g?"":g,K=e.ccOption,S=void 0===K?{}:K;l=l||d;var w=d,b={};b.persistStoredKeys=void 0===S.persistStoredKeys?void 0!==h&&h:S.persistStoredKeys,b.tag=S.tag||E;var O=function(e,t,r,n){var o;if(e)r&&fn("now the ccClass is singleton, you needn't supply ccKey to instance props, cc will ignore the ccKey["+r+"]"),o=t;else if(r)o=pn(t,r);else{var c=nn(n);o=pn(t,c)}return o}(a,i,s,b.tag);if(b.renderKey=S.renderKey||O,In(Un,b.renderKey).push(O),b.storedKeys=function(e,t,r,n){var o=r||n;return o?"*"===o?Object.keys(e).filter(function(e){return!t.includes(e)}):(ct(t,o),o):[]}(p,Sn[w],S.storedKeys,v),s&&!i)throw Error("missing ccClassKey while init a cc ins with ccKey["+s+"]");if(0<b.storedKeys.length&&!s)throw An(ae.CC_STORED_KEYS_NEED_CCKEY,Dn("ccClassKey["+i+"]"));var U=Kn[i],N=U.connectedComputed||{},A=U.connectedState||{},D=wn(d),I=On[d]||{},M=On[ee]||{},R=wn(ee),x=se(Nn(p),Sn[w]),T=En._state[O]||{},k=Object.assign({},p,T,D),$=Nn(c.state=k);Lr(c,a,i,s,O);var j=ue(bn,d);j.includes(i)||j.push(i);function L(e,t){jt(e,t,c)}function F(e,t,r,n,o,c){L(t,{calledBy:r,module:e,renderKey:o,delay:c,reactCallback:n})}function P(e,t,r,n,o){F(e,t,ne,r,n,o)}function q(e,t,r,n,o){"string"==typeof e?P(e,t,r,n,o):F(w,e,re,t,r,n)}function H(e,t,r){F(w,c.state,oe,e,t,r)}var V=[],B=[],G=[],z={effectItems:B,eid_effectReturnCb_:{},effectPropsItems:G,eid_effectPropsReturnCb_:{}},W={},Y=yn(c.props),X=((r={type:f,isSingle:a,module:d,reducerModule:l,ccClassKey:i,ccKey:s,ccUniqueKey:O,renderCount:1,initTime:Date.now(),watchedKeys:m,privStateKeys:x,connect:C,persistStoredKeys:b.persistStoredKeys,storedKeys:b.storedKeys,renderKey:b.renderKey,tag:b.tag,prevProps:Y,props:Y,mapped:{},prevState:k,state:k,moduleState:D,globalState:R,connectedState:A,extra:{},refComputed:{},moduleComputed:I,globalComputed:M,connectedComputed:N,moduleReducer:{},connectedReducer:{},reducer:{}}).mapped={},r.prevModuleStateVer={},r.stateKeys=$,r.onEvents=V,r.computedDep={},r.computedRetKeyFns={},r.watchDep={},r.watchRetKeyFns={},r.execute=null,r.auxMap=W,r.effectMeta=z,r.reactSetState=n,r.reactForceUpdate=o,r.setState=q,r.setModuleState=P,r.forceUpdate=H,r.changeState=L,r.__$$ccForceUpdate=ar(c),r.__$$ccSetState=cr(c),r);c.ctx=X,c.setState=q,c.forceUpdate=H,X.initState=function(e){if(!c.__$$isBeforeFirstRender)throw Error("ctx.initState can only been called before first render period!");if(!ie(p))throw Error("state must be a plain json object!");c.state=Object.assign({},p,e,T,D),X.prevState=X.state=c.state};var J=sr(c,!1,!1,w,w);if(X.dispatch=J,1<t&&(X.lazyDispatch=sr(c,!0,!1,w,w),X.silentDispatch=sr(c,!1,!0,w,w),X.dispatchLazy=X.lazyDispatch,X.dispatchSilent=X.silentDispatch,X.invoke=ir(c),X.lazyInvoke=ir(c,{isLazy:!0}),X.silentInvoke=ir(c,{isLazy:!1,isSilent:!0}),X.invokeLazy=X.lazyInvoke,X.invokeSilent=X.silentInvoke,X.setGlobalState=function(e,t,r,n){F(ee,e,re,t,r,n)}),2<t&&(X.syncBool=function(e,t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r=-1),"string"==typeof e)return gn.bind(null,((n={})[te]=e,n.type="bool",n.delay=r,n.rkey=t,n),c);gn({type:"bool"},e,c)},X.sync=function(e,t,r,n){var o;if(void 0===r&&(r=""),void 0===n&&(n=-1),"string"==typeof e)return gn.bind(null,((o={})[te]=e,o.type="val",o.val=t,o.delay=n,o.rkey=r,o),c);gn({type:"val"},c,e)},X.set=function(e,t,r,n){var o;void 0===r&&(r=""),void 0===n&&(n=-1),gn(((o={})[te]=e,o.type="val",o.val=t,o.delay=n,o.rkey=r,o),c)},X.setBool=function(e,t,r){var n;void 0===t&&(t=""),void 0===r&&(r=-1),gn(((n={})[te]=e,n.type="bool",n.delay=r,n.rkey=t,n),c)},X.syncInt=function(e,t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r=-1),"string"==typeof e)return gn.bind(null,((n={})[te]=e,n.type="int",n.delay=r,n.rkey=t,n),c);gn({type:"int"},c,e)}),3<t){X.emit=function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];Xr.apply(en,[Qr(e)].concat(r))},X.off=function(e,t){var r=void 0===t?{}:t,n=r.module,o=r.ccClassKey,c=r.ccUniqueKey,a=void 0===c?O:c,i=Qr(e);Jr(i.name,{module:n,ccClassKey:o,ccUniqueKey:a,identity:i.identity})};var Z=function(e,t,r){void 0===r&&(r=!0);var n=Qr(e),o=n.name,c=n.identity,a=void 0===c?null:c;r?V.push({event:o,handler:t,identity:a}):Yr(w,i,O,o,a,t)};X.on=Z,X.onDirectly=function(e,t){Z(e,t,!1)}}if(4<t){X.execute=function(e){return X.execute=e},X.aux=function(e,t){if(W[e])throw Error("auxMethod["+e+"] already defined!");W[e]=t},X.watch=function(c){return function(e,t,r,n,o){un(ce,{type:"watch",refCtx:c,stateKeys:c.stateKeys,retKeyFns:c.watchRetKeyFns,module:c.module,connect:c.connect,dep:c.watchDep},e,t,r,n,o)}}(X),X.computed=function(o){return function(e,t,r,n){un(ce,{type:"computed",refCtx:o,stateKeys:o.stateKeys,retKeyFns:o.computedRetKeyFns,module:o.module,connect:o.connect,dep:o.computedDep},e,t,r,n)}}(X);var Q=function(a){return function(e,t,r,n){var o;if(void 0===r&&(r=!0),"function"!=typeof e)throw Error("type of defineEffect first param must be function");if(null!=t&&!Array.isArray(t))throw Error("type of defineEffect second param must be one of them(array, null, undefined)");var c=((o={fn:e,depKeys:t,eId:n||Symbol("__autoGen_"+ ++Mn+"__")}).depKeys=t,o.immediate=r,o);a.push(c)}};X.effect=Q(B),X.effectProps=Q(G)}}var xn=Ae.store.getState,Tn={payload:null,renderKey:"",delay:-1};var kn=S,$n=W,jn=x,Ln=Ae.reducer,Fn=Ln._reducerModule_fnNames_,Pn=Ln._reducerCaller,qn=Ae.runtimeVar;function Hn(r,e,t){r.__$$isUnmounted=!1,r.__$$isBeforeFirstRender=!0;var n=r.ctx,c=n.connectedReducer,a=n.moduleReducer,i=n.dispatch,u=n.module,o=$n(n.connect).slice();if(o.includes(u)?jn("module["+u+"] is in belongTo and connect both, it will cause redundant render."):o.push(u),o.forEach(function(o){var e;e=o===u?a:kn(c,o),(Fn[o]||[]).forEach(function(n){e[n]=function(e,t,r){return i(o+"/"+n,e,t,r)}})}),n.reducer=Pn,e){if("function"!=typeof e)throw Error("type of setup must be function");var s=e(n)||{};if(!ie(s))throw Error("type of setup return result must be an plain json object");(!0===t||!0===qn.bindCtxToMethod&&!1!==t)&&$n(s).forEach(function(e){var t=s[e];"function"==typeof t&&(s[e]=t.bind(r,n))}),n.settings=s}!function(e){var r=e.ctx,t=r.hasComputedFn,n=r.hasWatchFn,o=r.module,c=W(r.connect),a=r.state;t&&(st(r,o,a,a,Tn,!0,!0),c.forEach(function(e){var t=xn(e);st(r,e,t,t,Tn,!0,!0)})),n&&(ut(r,o,a,a,Tn,!0,!0),c.forEach(function(e){var t=xn(e);ut(r,e,t,t,Tn,!0,!0)}))}(r)}var Vn=Ae.moduleName_stateKeys_,Bn=Ae.store,Gn=Bn.getPrevState,zn=Bn.getState,Wn=Bn.getStateVer,Yn=function(e,t){return x("effect: key["+e+"] is invalid, its "+t+" has not been declared in' store!")};function Xn(e,t){function r(n,o,c){return function(e){var t=e.eId;if(!c||!1!==e.immediate){var r=(0,e.fn)(h,o);r&&(n[t]=r)}}}var h=e.ctx,n=h.effectMeta,o=n.effectItems,c=n.eid_effectReturnCb_,a=n.effectPropsItems,i=n.eid_effectPropsReturnCb_,m=h.prevModuleStateVer;if(t)o.forEach(r(c,!0,!0)),a.forEach(r(i,!0,!0));else{var _=h.prevState,C=e.state,g=[];o.forEach(function(e){var t=e.depKeys,r=e.fn,n=e.eId;if(t){var o=t.length;if(0===o)return;for(var c=!1,a=0;a<o;a++){var i=t[a],u=void 0,s=void 0,d=void 0;if(i.includes("/")){var l=i.split("/"),f=l[0],p=l[1],y=Gn(f),v=Wn(f);if(m[p]===v[p])continue;if(h.prevModuleStateVer[p]=v[p],!y){Yn(i,"module["+f+"]");continue}if(!Vn[f].includes(p)){Yn(i,"unmoduledKey["+p+"]");continue}u=zn(f),s=y,d=p}else u=C,s=_,d=i;if(s[d]!==u[d]){c=!0;break}}c&&g.push({fn:r,eId:n})}else g.push({fn:r,eId:n})}),g.forEach(r(c,!1,!1));var u=h.prevProps,s=h.props,d=[];a.forEach(function(e){var t=e.depKeys,r=e.fn,n=e.eId;if(t){var o=t.length;if(0===o)return;for(var c=!1,a=0;a<o;a++){var i=t[a];if(u[i]!==s[i]){c=!0;break}}c&&d.push({fn:r,eId:n})}else d.push({fn:r,eId:n})}),d.forEach(r(i,!1,!1))}}function Jn(e){e.__$$isBeforeFirstRender=!1;var t=e.ctx,r=t.module,n=t.ccClassKey,o=t.ccUniqueKey;t.onEvents.forEach(function(e){Yr(r,n,o,e.event,e.identity,e.handler)}),Xn(e,!0)}function Zn(e){Xn(e),e.ctx.prevState=e.state}var Qn=Ae.ccUkey_ref_,eo=Ae.ccUKey_handlerKeys_,to=Ae.runtimeVar,ro=Ae.ccClassKey_ccClassContext_,no=Ae.handlerKey_handler_,oo=Ae.renderKey_ccUkeys_;function co(e,t,r){to.isDebug&&console.log(y(t+" unset ref"),p("purple")),delete Qn[t];var n=oo[r];r===t?delete oo[r]:n.splice(n.indexOf(t),1);var o=ro[e].ccKeys,c=o.indexOf(t);c<0||o.splice(c,1),function(e){void 0===$r[e]?$r[e]=0:$r[e]-=1}(t);var a=eo[t];a&&a.forEach(function(e){delete no[e]})}var ao=W;function io(r,n){function e(e){var t=r[e];"function"==typeof t&&t(n)}Object.getOwnPropertySymbols(r).forEach(e),ao(r).forEach(e)}function uo(e){e.__$$isUnmounted=!0;var t=e.ctx,r=t.effectMeta,n=r.eid_effectPropsReturnCb_;io(r.eid_effectReturnCb_,t),io(n,t);var o=t.ccUniqueKey,c=t.ccClassKey,a=t.renderKey;Zr(o),co(c,o,a)}var so=function(e){return"CC("+e+")"},lo=W,fo=K,po=Ae.runtimeVar,yo=p,vo=y,ho=function(e){return Error("can not defined setup both in register options and class body --verbose:"+e)};function mo(e,t){var r=void 0===e?{}:e,n=r.module,o=void 0===n?V:n,c=r.state,u=void 0===c?{}:c,a=r.watchedKeys,i=void 0===a?"*":a,s=r.storedKeys,d=void 0===s?[]:s,l=r.setup,f=void 0===l?null:l,p=r.persistStoredKeys,y=r.connect,v=void 0===y?{}:y,h=r.tag,m=r.lite,_=r.reducerModule,C=r.isPropsProxy,g=void 0!==C&&C,E=r.isSingle,K=void 0!==E&&E,S=r.renderKeyClasses,w=r.__checkStartUp,b=void 0===w||w,O=r.compareProps,U=void 0===O||O,N=r.__calledBy;void 0===t&&(t="");try{var A=Nr(o,t,S,T,i,d,v,_,b,N),D=A._module,I=A._reducerModule,M=A._watchedKeys,R=A._ccClassKey,x=A._connect;return function(r){if(r.prototype&&r.prototype.$$attach)throw Error("register a cc class is prohibited!");var e=!1===g?r:$.Component,i=e.$$setup,t=function(a){function e(e,t){var r;try{r=a.call(this,e,t)||this;var n="function"==typeof u?u():u,o=Object.assign(r.state||{},n);r.$$attach=r.$$attach.bind(Te(r));var c=Object.assign({},e,{isSingle:K,module:D,reducerModule:I,tag:h,state:o,type:T,watchedKeys:M,ccClassKey:R,connect:x,storedKeys:d,persistStoredKeys:p});if(Rn(Te(r),c,m),f&&(r.$$setup||i))throw ho("ccUniqueKey "+r.ctx.ccUniqueKey);r.$$setup&&(r.$$setup=r.$$setup.bind(Te(r))),Hn(Te(r),f||r.$$setup||i,!1)}catch(e){ke(e)}return r}xe(e,a);var t=e.prototype;return t.shouldComponentUpdate=function(e,t){var r=this.ctx.childRef;if(r&&r.shouldComponentUpdate)return r.shouldComponentUpdate(e,t);if(a.prototype.shouldComponentUpdate)return a.prototype.shouldComponentUpdate.call(this,e,t);var n=!!U&&fo(this.props,e);return this.state!==t||n},t.$$attach=function(e){var t=this.ctx;((t.childRef=e).ctx=t).reactSetState=e.setState.bind(e),t.reactForceUpdate=e.forceUpdate.bind(e),e.setState=t.setState,e.forceUpdate=t.forceUpdate,t.__$$ccSetState=cr(e,this),t.__$$ccForceUpdate=ar(e);var r=e.state,n=this.state;r||(r=e.state={});var o=Object.assign({},r,n);if(lo(t.state=e.state=o).forEach(function(e){return n[e]=o[e]}),e.$$setup&&(e.$$setup=e.$$setup.bind(e)),f&&(e.$$setup||i))throw ho("ccUniqueKey "+t.ccUniqueKey);Hn(e,f||e.$$setup||i,!1)},t.componentDidMount=function(){a.prototype.componentDidMount&&a.prototype.componentDidMount.call(this),Jn(this)},t.componentDidUpdate=function(){a.prototype.componentDidUpdate&&a.prototype.componentDidUpdate.call(this),Zn(this)},t.componentWillUnmount=function(){a.prototype.componentWillUnmount&&a.prototype.componentWillUnmount.call(this),uo(this)},t.render=function(){return this.ctx.prevProps=this.ctx.props,this.ctx.props=this.props,po.isDebug&&console.log(vo("@@@ render "+so(R)),yo()),!1===g?a.prototype.render.call(this):$.createElement(r,{ctx:this.ctx,$$attach:this.$$attach})},e}(e);return t.displayName=R===z?"CcDispatcher":so(R),t}}catch(e){ke(e)}}function _o(e){var t=function(e){function t(){return e.apply(this,arguments)||this}return xe(t,e),t.prototype.render=function(){return this.props.children||$.createElement("span",{style:{display:"none"}})},t}($.Component);if(Ae.refs[z]){if(!Ae.isHotReloadMode())throw Error("CcDispatcher can only be initialize one time");U("hot reload mode, CC_DISPATCHER existed")}var r=e||t;return mo({isSingle:!0,__checkStartUp:!1,__calledBy:"cc"},z)(r)}var Co={},go=function(e,t,r){if(![ae.CC_MODULE_NAME_DUPLICATE,ae.CC_REDUCER_MODULE_NAME_DUPLICATE].includes(e.code)||!Ae.isHotReloadMode())throw e;var n=function(e){e||(e="");for(var t=e.split("\n"),r=t.length,o="",c=0;c<r;c++)if(t[c].includes(".checkModuleNameAndState")){!function(){var e=t[c+3].split(":"),r=e.length-1,n=[];e.forEach(function(e,t){t!==r&&n.push(e)}),o=n.join(":")}();break}return o}(e.stack),o=r+"|--link--|"+t,c=Co[o];if(c){if(n!==c)throw e}else Co[o]=n};function Eo(t,e,r){void 0===r&&(r=!0);var n=t===G?{}:e;try{!function(e,t,r){if(ot(e,r),!ie(t))throw Error("module["+e+"]'s state "+Je)}(t,n,r)}catch(e){go(e,t,"state")}var o=Ae.store,c=o.getState(),a=o.getStateVer();o.getPrevState()[t]=Object.assign({},c[t]=n),a[t]=W(n).reduce(function(e,t){return e[t]=1,e},{});var i=Object.keys(n);if(Ae.moduleName_stateKeys_[t]=i,t===ee){var u=Ae.globalStateKeys;i.forEach(function(e){return u.push(e)})}}var Ko=l,So=x;function wo(e,t,r,n,o){return function(e,t,r,n,o){void 0===r&&(r="");var c,a=void 0===o?{}:o,i=a.ccClassKey,u=a.ccKey,s=a.throwError;if(void 0===e&&void 0===t)throw Error("api doc: cc.dispatch(action:Action|String, payload?:any, delay?:number, idt?:string), when action is String, second param means payload");try{if(i&&u){var d=Ko(i,u),l=Ae.refs[d];if(!l)throw Error("no ref found for uniqueCcKey:"+d+"!");c=l.ctx.dispatch}else{var f,p="";"string"==typeof e&&e.includes("/")&&(p=e.split("/")[0]),f="*"!==p?Ft(p):Ft(),c=f.ctx.dispatch}if("string"==typeof e&&e.startsWith("*")){var y=e.split("/").pop(),v=Ae.reducer._reducerFnName_fullFnNames_[y];if(!v)return;var h=[];return v.forEach(function(e){h.push(c(e,t,r,n))}),Promise.all(h)}return c(e,t,r,n)}catch(e){if(s)throw e;So(e.message)}}(e,t,r,n,o)}function bo(c,e,t,r){if(void 0===t&&(t=!0),e){try{t?function(e){var t=Ae.reducer._reducer;if(nt(e),e!==ee&&t[e])throw rt(ae.CC_REDUCER_MODULE_NAME_DUPLICATE,tt("module["+e+"]"))}(c):nt(c)}catch(e){go(e,c,"reducer")}var n=Ae.reducer,o=n._reducer,a=n._reducerCaller,i=n._reducerFnName_fullFnNames_,u=n._reducerModule_fnNames_,s=Object.assign({},e);o[c]=s;var d=S(a,c),l=ue(u,c);s.setState||(s.setState=function(e){return e}),W(s).forEach(function(e){l.includes(e)||l.push(e);var n=c+"/"+e;d[e]=function(e,t,r){return wo(n,e,t,r)};var o=s[e];if("function"!=typeof o)throw Error("reducer key["+e+"] 's value is not a function");var t=o;o.__fnName&&(s[e]=t=function(e,t,r){return o(e,t,r)}),t.__fnName=e,t.__stateModule=c,t.__reducerModule=c,t.__ctName=o.__ctName||o.constructor.name;var r=ue(i,e);r.includes(n)||r.push(n)})}}var Oo=ie,Uo=S,No=W,Ao={payload:null,renderKey:"",delay:-1};function Do(r,e,t){if(void 0===t&&(t=!1),!Oo(e))throw Error("StartUpOption.watch."+r+"'s value "+Je);ot(r,!1,"watch."+r+" is invalid");var n=Ae.watch.getRootWatchDep(),o=Ae.watch.getRootWatchRaw(),c=Ae.computed.getRootComputedValue();if(t){var a=o[r];a?Object.assign(a,e):o[r]=e}else o[r]=e;var i=(0,Ae.store.getState)(r);un(m,{module:r,stateKeys:No(i),dep:n},e);var u=Ae.getDispatcher(),s=Object.assign({},i),d=Uo(c,r);_e(u&&u.ctx,r,u&&u.ctx.module,i,function(e,t){return ye(t,m,"watch",n,r,i,e)},i,i,s,Ao,!0,"watch",m,d)}var Io=S,Mo=ie,Ro={payload:null,renderKey:"",delay:-1};function xo(r,e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!0),!Mo(e))throw Error("StartUpOption.computed."+r+"'s value "+Je);ot(r,!1,"computed."+r+" is invalid");var o=Ae.computed,c=Ae.store.getState(),a=o.getRootComputedValue(),i=o.getRootComputedDep(),u=o.getRootComputedRaw();if(t){var s=u[r];s?Object.assign(s,e):u[r]=e}else u[r]=e;var d=c[r];!0===n&&un(m,{module:r,stateKeys:W(d),dep:i},e);var l=Ae.getDispatcher(),f=Object.assign({},d),p=Io(a,r);_e(l&&l.ctx,r,l&&l.ctx.module,d,function(e,t){return ye(t,m,"computed",i,r,d,e)},d,d,f,Ro,!0,"computed",m,p)}var To=ie,ko=W;function $o(e){if(!To(e))throw Error("StartupOption.moduleSingleClass "+Je);!function(t,r){Object.keys(r).forEach(function(e){t[e]=r[e]})}(Ae.moduleSingleClass,e)}function jo(e){if(0<e.length){var o=Ae.plugins;o.length=0,ze.forEach(function(e){return We[e].length=0});var c={};e.forEach(function(e){if(o.push(e),!e.install)throw Error("a plugin must export install handler!");var t=e.install(Xe),r=Error("plugin.install must return result:{name:string, options?:object}");if(!t)throw r;var n=t.name;if(!n)throw r;if(c[n])throw Error("pluginName["+n+"] duplicate");c[n]=1})}}var Lo=function(e){var t=document.querySelector("#"+o);if(!t){(t=document.createElement("div")).id=o;var r=t.style;r.position="fixed",r.left=0,r.top=0,r.display="none",r.zIndex=-888666,document.body.appendChild(t)}n.render($.createElement(e),t)},Fo=!1;function Po(e){_(Ae.refRetKey_fnUid_),_(Ae.event_handlers_),_(Ae.ccUKey_handlerKeys_),_(Ae.renderKey_ccUkeys_);var t=Ae.ccClassKey_ccClassContext_;if(Object.keys(t).forEach(function(e){_(t[e].ccKeys)}),_(Ae.handlerKey_handler_),_(Ae.ccUkey_ref_,[z]),_(Ae.refs,[z]),e){var r=Ae.computed._computedValue;W(Ae.store._state).forEach(function(e){e===B||r[e]&&xo(e,r[e],!1,!1)})}}function qo(e){void 0===e&&(e=!1),_(Ae.globalStateKeys);var t=W(Ae.moduleName_isConfigured_).concat([V,B,ee,r]);_(Ae.reducer._reducer,t),_(Ae.store._state,t,{}),_(Ae.computed._computedDep,t),_(Ae.computed._computedValue,t),_(Ae.watch._watchDep),_(Ae.middlewares),fe={module:{computed:{},watch:{}},ref:{computed:{},watch:{},effect:{}}},Po(e)}function Ho(e,t){void 0===e&&(e=!1),function(e){Ae.isCcAlreadyStartup?Ae.isHotReloadMode()?e():console.warn("clear failed because of not running under hot reload mode!"):Fo=!0}(function(){if(e)Fo=!0,qo(),console.warn(t);else{if(Fo)return void(Fo=!1);console.warn("attention: method[clearContextIfHot] need been invoked before your app rendered!"),function(){if(!Ae.refs[z]){var e=_o();Lo(e)}}(),Po(!0)}})}var Vo=U,Bo=E,Go=d;function zo(e,t){var r=void 0===e?{}:e,n=r.store,o=void 0===n?{}:n,c=r.reducer,a=void 0===c?{}:c,i=r.init,u=void 0===i?null:i,s=r.computed,d=void 0===s?{}:s,l=r.watch,f=void 0===l?{}:l,p=r.moduleSingleClass,y=void 0===p?{}:p,v=r.middlewares,h=void 0===v?[]:v,m=void 0===t?{}:t,_=m.plugins,C=void 0===_?[]:_,g=m.isStrict,E=void 0!==g&&g,K=m.isDebug,S=void 0!==K&&K,w=m.errorHandler,b=void 0===w?null:w,O=m.isHot,U=void 0!==O&&O,N=m.autoCreateDispatcher,A=void 0===N||N,D=m.bindCtxToMethod,I=void 0!==D&&D,M=m.computedCompare,R=void 0===M||M,x=m.watchCompare,T=void 0===x||x,k=m.watchImmediate,$=void 0!==k&&k,j=m.alwaysGiveState,L=void 0===j||j,F=m.reducer;try{if(F){if(!ie(F))throw Error("option.reducer not a plain json object");W(F).forEach(function(t){if(a[t])throw Error("reducerModule["+t+"] has been declared in store");var r=F[t];W(r).forEach(function(e){r[e].__reducerModule=t}),a[t]=r})}console.log("%c window.name:"+window.name,"color:green;border:1px solid green"),Vo("cc version "+Ae.info.version),Ae.isHot=U,Ae.errorHandler=b;var P=Ae.runtimeVar;if(P.alwaysGiveState=L,P.isStrict=E,P.isDebug=S,P.computedCompare=R,P.watchCompare=T,P.watchImmediate=$,P.bindCtxToMethod=I,Ho(!0,Go(ae.CC_ALREADY_STARTUP)),$o(y),function(e){if(e[G]={},!To(e))throw Error("the storeState "+Je);Ae.store.initStateDangerously(B,{}),void 0===e[ee]&&(e[ee]={}),void 0===e[V]&&(e[V]={});for(var t=ko(e),r=t.length,n=0;n<r;n++){var o=t[n];Eo(o,e[o])}}(o),function(e){void 0===e[V]&&(e[V]={}),void 0===e[ee]&&(e[ee]={});for(var t=ko(e),r=t.length,n=0;n<r;n++){var o=t[n];bo(o,e[o])}}(a),function(t){if(!To(t))throw Error("StartUpOption.computed "+Je);ko(t).forEach(function(e){return xo(e,t[e])})}(d),function(t){if(!To(t))throw Error("StartUpOption.watch "+Je);Object.keys(t).forEach(function(e){return Do(e,t[e])})}(f),function(r){if(r){if(!To(r))throw Error("StartupOption.init "+Je);ko(r).forEach(function(t){ot(t,!1);var e=r[t];e&&Promise.resolve().then(e).then(function(e){dr(t)(e)})}),Ae.init._init=r}}(u),function(e){if(0<e.length){var t=Ae.middlewares;t.length=0,e.forEach(function(e){return t.push(e)})}}(h),!A)throw Error("customizing Dispatcher is not allowed in current version Concent");if(Ae.refs[z])Vo("[[startUp]]: CcDispatcher already existed");else{var q=_o();Lo(q),Vo("[[startUp]]: cc create a CcDispatcher automatically")}var H=function(e){Bo("CC_CONTEXT",Ae,e),Bo("ccc",Ae,e),Bo("cccc",Ae.computed._computedValue,e),Bo("sss",Ae.store._state,e)};window.mcc?setTimeout(function(){H(window.mcc[Y()])},1200):H(),Ae.isCcAlreadyStartup=!0,jo(C)}catch(e){if(!b)throw e;b(e)}}var Wo=ie;function Yo(t,e){if(!Ae.isCcAlreadyStartup)throw Error("cc.configure must be called after cc.run!");if(!Wo(e))throw Error("[[configure]] config "+Je);if(t===ee)throw Error("configuring global module is not allowed");var r=e.state,n=e.reducer,o=e.computed,c=e.watch,a=e.init,i=e.isClassSingle;if(n&&!Wo(n))throw Error("[[configure]] config.reducer "+Je);if(Eo(t,r,!0),bo(t,n,!0),o&&xo(t,o),c&&Do(t,c),Ae.moduleSingleClass[t]=!0===i,a){if("function"!=typeof a)throw Error("init value must be a function!");Promise.resolve().then(a).then(function(e){dr(t)(e)})}Ae.moduleName_isConfigured_[t]=!0,Ye(14,t)}function Xo(n,o){var c={};return W(n).forEach(function(e){function t(){return r.apply(void 0,arguments)}var r=n[e];t.__fnName=e,t.__stateModule=o,t.__reducerModule=o,c[e]=t}),c}function Jo(e){throw Error("[[run]]: param error, "+e+" "+Je)}var Zo=ie,Qo=W,ec=s;function tc(e,t){var r=F(e);return delete r.__checkStartUp,delete r.__calledBy,mo(r,t)}var rc=K,nc=F,oc=$.createElement("span",{style:{display:"none"}}),cc=function(D){function e(e,t){var r;r=D.call(this,e,t)||this;var n=nc(e.register),o=n.module,c=n.renderKeyClasses,a=n.tag,i=n.lite,u=n.compareProps,s=void 0===u||u,d=n.setup,l=n.bindCtxToMethod,f=n.watchedKeys,p=void 0===f?"*":f,y=n.connect,v=void 0===y?{}:y,h=n.reducerModule,m=n.isSingle,_=n.storedKeys,C=void 0===_?[]:_,g=n.state||{};"function"==typeof g&&(g=g());var E=e.ccClassKey,K=e.ccKey,S=e.ccOption,w=void 0===S?{}:S,b=h,O=p,U=E,N=v;if(!0!==e.__$$regDumb){var A=Nr(o,E,c,I,p,C,v,h,!0);b=A._reducerModule,O=A._watchedKeys,U=A._ccClassKey,N=A._connect}return Rn(Te(r),{isSingle:m,ccKey:K,connect:N,state:g,module:o,reducerModule:b,storedKeys:C,watchedKeys:O,tag:a,ccClassKey:U,ccOption:w,type:I},i),r.__$$compareProps=s,Hn(Te(r),d,l),r}xe(e,D);var t=e.prototype;return t.componentDidMount=function(){Jn(this)},t.shouldComponentUpdate=function(e,t){var r=!!this.__$$compareProps&&rc(yn(e),yn(this.props));return this.state!==t||r},t.componentDidUpdate=function(){Zn(this)},t.componentWillUnmount=function(){D.prototype.componentWillUnmount&&D.prototype.componentWillUnmount.call(this),uo(this)},t.render=function(){var e=this.props;this.ctx.prevProps=this.ctx.props,this.ctx.props=yn(e);var t=e.render,r=t||e.children;if("function"==typeof r){var n=e.register,o=void 0===n?{}:n,c=this.ctx;return!0!==e.__$$regDumb&&o.mapProps?(c.mapped=o.mapProps(c)||{},r(c.mapped)||oc):r(c)||oc}if($.isValidElement(r))throw Error("CcFragment's children can not b a react dom ");return r},e}($.Component);function ac(e,t){var r=F(e),n=r.watchedKeys,o=r.render,c=r.connect,a=Nr(r.module,t,r.renderKeyClasses,I,void 0===n?"*":n,r.storedKeys,void 0===c?{}:c,r.reducerModule,!0),i=a._reducerModule,u=a._watchedKeys,s=a._ccClassKey,d=a._connect;function l(t){return function(e){return r.props=e,function(t,e){var r=e.mapProps,n=e.props,o=void 0===n?{}:n,c={__$$regDumb:!0,props:o,ccOption:o.ccOption,ccClassKey:e.ccClassKey,render:function(e){return r?(e.mapped=r(e),$.createElement(t,e.mapped)):$.createElement(t,e)},ccKey:o.ccKey,register:e};return $.createElement(cc,c)}(t,r)}}return r.module=a._module,r.reducerModule=i,r.watchedKeys=u,r.ccClassKey=s,r.connect=d,o?l(o):function(e){return l(e)}}var ic=Ae.ccUkey_ref_,uc=1,sc={};var dc=function(n,o){return function(e,t){n.state=Object.assign({},n.state,e);var r=Object.assign({},n);o(r),t&&t(r.state)}},lc=function(r,n){return function(e){var t=Object.assign({},r);n(t),e&&e(t.state)}};function fc(e,t,r){this.setState=dc(e,t),this.forceUpdate=lc(e,t),this.state=e.state,this.isFirstRendered=!0,this.props=r}function pc(e,t){var r=F(e),n=r.state,o=void 0===n?{}:n,c=r.props,a=void 0===c?{}:c,i=r.mapProps,u=r.layoutEffect,s=void 0!==u&&u,d=r.extra,l=void 0===d?{}:d,f=o;"function"==typeof o&&(f=o(),r.state=f);var p=$.useState;if(!p)throw Error("make sure your react version is LTE 16.8");var y,v=uc,h=p({cursor:v,state:o}),m=h[0],_=h[1],C=m.cursor,g=r.bindCtxToMethod;if(C===v){var E=r.watchedKeys,K=r.storedKeys,S=r.connect,w=r.setup,b=r.lite;uc+=1;var O=Nr(r.module,t,r.renderKeyClasses,j,void 0===E?"*":E,void 0===K?[]:K,void 0===S?{}:S,r.reducerModule,!0),U=O._module,N=O._reducerModule,A=O._watchedKeys,D=O._ccClassKey,I=O._connect;y=new fc(m,_,a);var M=Object.assign({},r,{module:U,reducerModule:N,watchedKeys:A,state:f,type:j,ccClassKey:D,connect:I,ccOption:a.ccOption});Rn(y,M,b),Hn(y,w,g),sc[C]=y.ctx.ccUniqueKey}else{var R=(y=ic[sc[C]]).ctx;R.reactSetState=dc(m,_),R.reactForceUpdate=lc(m,_)}var x=y.ctx;x.prevProps=x.props,x.props=a,x.extra=l,y.props=a;var T=s?$.useLayoutEffect:$.useEffect;if(T(function(){y.isFirstRendered||Zn(y)}),T(function(){if(!1===y.isFirstRendered){var e=y.ctx;Lr(y,e.isSingle,e.ccClassKey,e.ccKey,e.ccUniqueKey)}else y.isFirstRendered=!1,Jn(y);return function(){uo(y)}},[]),i){var k=i(x);if(!ie(k))throw Error("mapProps must return an plain json object");x.mapped=k}return x}function yc(){throw Error("api doc: cc.setState(module:string, state:object, renderKey:string, delayMs?:number, skipMiddleware?:boolean, throwError?:boolean)")}function vc(e){return Ae.store.getState(e)}var hc=Ae.computed._computedValue;var mc=Ae.ccUkey_ref_,_c=Ae.ccClassKey_ccClassContext_;function Cc(){var r=[],n=Ae.ccUkey_ref_;return W(n).forEach(function(e){var t=n[e];t&&!t.__$$isUnmounted&&r.push(t)}),r}function gc(e,t,r){var n=void 0===r?{}:r,o=n.state,c=n.reducer,a=n.computed,i=n.watch,u=n.init;if(!Ae.isCcAlreadyStartup)throw Error("cc is not startup yet");nt(e),ot(t,!1);var s=function(e){return JSON.parse(JSON.stringify(e))}(Ae.store.getState(t));o&&Object.assign(s,o);var d=Xo(Ae.reducer._reducer[t]||{},e);c&&Object.assign(d,Xo(c,e));var l=Ae.computed._computedRaw[t]||{};a&&Object.assign(l,a);var f=Ae.watch._watchRaw[t]||{};i&&Object.assign(f,i);var p=Ae.init._init[t];u&&(p=u);var y={state:s,reducer:d,computed:l,watch:f};p&&(y.init=p),Yo(e,y)}function Ec(u,e){void 0===u&&(u={}),void 0===e&&(e={}),Zo(u)||Jo("store"),Zo(e)||Jo("option");var s={store:{},reducer:{},watch:{},computed:{},init:{},moduleSingleClass:{}};Qo(u).forEach(function(e){var t=u[e],r=t.state,n=t.reducer,o=t.watch,c=t.computed,a=t.init,i=t.isClassSingle;r&&(s.store[e]=r),n&&(s.reducer[e]=n),o&&(s.watch[e]=o),c&&(s.computed[e]=c),a&&(s.init[e]=a),s.moduleSingleClass[e]=!0===i}),ec(s.init)&&(s.init=null),zo(s,e)}function Kc(e,t){return tc({connect:e},t)}function Sc(e,t){return ac({connect:e},t)}function wc(e,o){var c=F(e);function t(r){var e=c.memo,t=void 0===e||e;function n(){return function(e){c.props=e;var t=pc(c,o);return $.createElement(r,c.mapProps?t.mapped:t)}}return delete c.memo,t&&$.memo?$.memo(n()):n()}"function"==typeof c.state&&(c.state=c.state());var r=c.render;return r?t(r):function(e){return t(e)}}function bc(e,t,r,n,o){void 0===o&&(o=!1);try{Ft().ctx.setGlobalState(e,t,r,n)}catch(e){if(o)throw e;x(e.message)}}function Oc(e,t,r,n,o,c){void 0===n&&(n=-1),void 0===c&&(c=!1),void 0===e&&void 0===t&&yc(),"string"!=typeof e&&yc(),Pt(e,t,r,n,o)}function Uc(e,t,r,n){Ft().ctx.set(e,t,r,n)}function Nc(e,t){if(!e.includes("/"))throw Error("keyPath must start with module");var r=e.split("/"),n=vc(r[0]);return _n(e,t,!1,n,!1).state}function Ac(e){return Lc[e].connectedState||{}}function Dc(e){return e?hc[e]:hc}function Ic(e){if(void 0===e)throw Error("api doc: cc.emit(event:string|{name:string, identity?:string, ctx?:boolean}, ...args)");try{for(var t,r=Ft(),n=arguments.length,o=Array(1<n?n-1:0),c=1;c<n;c++)o[c-1]=arguments[c];(t=r.ctx).emit.apply(t,[e].concat(o))}catch(e){x(e)}}function Mc(e,t){try{Ft().ctx.off(e,t)}catch(e){if(t.throwError)throw e;x(e.message)}}function Rc(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];(function(e){var r=[],t=_c[e];return t&&t.ccKeys.forEach(function(e){var t=mc[e];t&&r.push(t)}),r})(e).forEach(function(e){var t;e.__$$isUnmounted||e.ctx.execute&&(t=e.ctx).execute.apply(t,r)})}function xc(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];Cc().forEach(function(e){var t;e.ctx.execute&&(t=e.ctx).execute.apply(t,r)})}function Tc(e,t,r){return{fn:e,depKeys:t,compare:r}}function kc(e,t){return void 0===t&&(t=!0),{fn:function(){return e},depKeys:[],compare:t}}function $c(e,t,r,n){return{fn:e,depKeys:t,compare:r,immediate:n}}function jc(e,t,r){return{fn:e,depKeys:t,compare:r,immediate:!0}}var Lc=Ae.ccClassKey_ccClassContext_,Fc=zo,Pc=tc,qc=ac,Hc=Yo,Vc=vc,Bc=Ae.store.getGlobalState,Gc=wo,zc=Ae,Wc=_o,Yc=Cc,Xc=Ae.reducer._reducerCaller,Jc=Ho,Zc=cc,Qc=i,ea=Ae.store.appendState,ta=pc,ra={cloneModule:gc,emit:Ic,off:Mc,connect:Kc,connectDumb:Sc,register:Pc,registerDumb:qc,registerHookComp:wc,configure:Hc,dispatch:Gc,startup:Fc,run:Ec,setGlobalState:bc,setState:Oc,set:Uc,setValue:Nc,getGlobalState:Bc,getState:Vc,getComputed:Dc,getConnectedState:Ac,ccContext:zc,createDispatcher:Wc,execute:Rc,executeAll:xc,getRefs:Yc,reducer:Xc,clearContextIfHot:Jc,CcFragment:Zc,cst:Qc,appendState:ea,useConcent:ta,bindCcToMcc:na,defComputed:Tc,defComputedVal:kc,defWatch:$c,defWatchImmediate:jc};function na(e){if(!ca)throw Error("current env is not multi concent ins mode");if(ca[e])throw Error("ccNamespace["+e+"] already existed in window.mcc");!function(e){w=e}(e),E(e,ra,ca)}function oa(){var e=w?window.mcc[w]:window.cc;if(e&&e.ccContext&&e.ccContext.info){var t=e.ccContext.info.version,r=zc.info.version;if(t!==r)throw Error("a existed version concent "+t+" is different with current about to import concent "+r+", \n        it may caused by some of your concent-eco-module with older version concent, please reinstall them (concent-*** module)")}}var ca=window.mcc;ca?setTimeout(function(){if(!Y())throw Error("detect window.mcc, but user forget call bindCcToMcc in bundle entry");oa()},1e3):(oa(),E("cc",ra)),e.startup=Fc,e.cloneModule=gc,e.run=Ec,e.connect=Kc,e.connectDumb=Sc,e.register=Pc,e.registerDumb=qc,e.registerHookComp=wc,e.configure=Hc,e.setGlobalState=bc,e.setState=Oc,e.set=Uc,e.setValue=Nc,e.getState=Vc,e.getGlobalState=Bc,e.getConnectedState=Ac,e.getComputed=Dc,e.emit=Ic,e.off=Mc,e.dispatch=Gc,e.ccContext=zc,e.createDispatcher=Wc,e.execute=Rc,e.executeAll=xc,e.getRefs=Yc,e.reducer=Xc,e.clearContextIfHot=Jc,e.CcFragment=Zc,e.cst=Qc,e.appendState=ea,e.useConcent=ta,e.defComputed=Tc,e.defComputedVal=kc,e.defWatch=$c,e.defWatchImmediate=jc,e.bindCcToMcc=na,e.default=ra,Object.defineProperty(e,"__esModule",{value:!0})});
